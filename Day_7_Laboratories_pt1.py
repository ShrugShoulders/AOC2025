def tachyon_manifold(manifold_diagram: str) -> int:
    """
    Analyzes the tachyon manifold diagram to count the total number of beam splits.
    A tachyon beam enters at 'S' and only moves downward.
    It passes through '.' freely.
    When it encounters a splitter '^', the beam stops, and two new beams
    start from its immediate left and immediate right positions in the next row.
    """
    # Parse the diagram into a grid
    grid = manifold_diagram.strip().split('\n')
    
    # Grid dimensions
    R = len(grid)
    if R == 0:
        return 0
    C = len(grid[0])
    start_col = -1
    start_row = 0
    try:
        start_col = grid[start_row].index('S')
    except ValueError:
        print("Error: 'S' (start position) not found in the first row.")
        return 0
    active_beams = {(start_row, start_col)}
    
    total_splits = 0
    current_row = start_row
    
    while current_row < R:
        
        # This set will hold the beams that will be active in the next row
        next_row_beams = set()
        
        # Process all beams currently active
        for r, c in active_beams:
            
            # Check if the beam is out of bounds
            # in the starting set, but safety check
            if not (0 <= c < C):
                continue # Beam is off the side
            
            # The current cell the beam is entering
            cell = grid[r][c]
            
            # Check for a splitter '^'
            if cell == '^':
                total_splits += 1
                
                # A split occurs, creating two new beams in the next row one to the left and one to the right.
                next_r = r + 1
                
                # Beam to the left: column c - 1
                left_c = c - 1
                if 0 <= left_c < C and next_r < R:
                    if 0 <= left_c < C:
                        next_row_beams.add((next_r, left_c))
                        
                    # Beam to the right 
                    right_c = c + 1
                    if 0 <= right_c < C:
                        next_row_beams.add((next_r, right_c))
                        
            # heck for empty space '.' or the starting position 'S'
            elif cell == '.' or cell == 'S':
                # Beam passes freely, continues to the cell directly below it.
                next_r = r + 1
                next_c = c
                
                # Add the new beam position for the next row
                if next_r < R:
                    next_row_beams.add((next_r, next_c))
            
        # Move to the next row and update the set of active beams
        current_row += 1
        active_beams = next_row_beams

    return total_splits

manifold_input = """
......................................................................S......................................................................
.............................................................................................................................................
......................................................................^......................................................................
.............................................................................................................................................
.....................................................................^.^.....................................................................
.............................................................................................................................................
....................................................................^.^.^....................................................................
.............................................................................................................................................
...................................................................^...^.^...................................................................
.............................................................................................................................................
..................................................................^.^.....^..................................................................
.............................................................................................................................................
.................................................................^...^.^.^.^.................................................................
.............................................................................................................................................
................................................................^...^.^.....^................................................................
.............................................................................................................................................
...............................................................^.^.^.^...^...^...............................................................
.............................................................................................................................................
..............................................................^.^.^.^.^.^.^.^.^..............................................................
.............................................................................................................................................
.............................................................^.....^.^.^.^.^...^.............................................................
.............................................................................................................................................
............................................................^.^.^...^.....^.^...^............................................................
.............................................................................................................................................
...........................................................^.^.^.^.^.^.^.^.^.^.^.^...........................................................
.............................................................................................................................................
..........................................................^...^...^...^.^.^.^...^.^..........................................................
.............................................................................................................................................
.........................................................^.^...^...^.^.^.^...^...^.^.........................................................
.............................................................................................................................................
........................................................^.^...^.^.^...^.^...^.^.^...^........................................................
.............................................................................................................................................
.......................................................^...^.^.......^.^.^.......^.^.^.......................................................
.............................................................................................................................................
......................................................^.^.^...^.^.....^.^...^.....^.^.^......................................................
.............................................................................................................................................
.....................................................^.^.^...^.^...^.^.^.^.^...^.^.....^.....................................................
.............................................................................................................................................
....................................................^.^.^.^...^...^.^.^.^.^.^...........^....................................................
.............................................................................................................................................
...................................................^...^.^.^.^.^.^.^.....^.^.^.........^.^...................................................
.............................................................................................................................................
..................................................^.^.^.^.^.^.^.^.^.^.^.^...^...^.^.^...^.^..................................................
.............................................................................................................................................
.................................................^...^.^...^.^.^.....^.^.^.........^.....^.^.................................................
.............................................................................................................................................
................................................^.......^...^.^.^.^.....^.....^.^...^...^.^.^................................................
.............................................................................................................................................
...............................................^.^.^.^.^.^.....^.^.^.^...^.^.^...^.^.^.^.^...^...............................................
.............................................................................................................................................
..............................................^...^.....^.......^.^...^...^.^.....^.^...^...^.^..............................................
.............................................................................................................................................
.............................................^.^.^.^...^.^.^.....^.^...^.^.^...^.....^.^.^.....^.............................................
.............................................................................................................................................
............................................^.^.....^.^...^...^.^...^.^.^.....^.^.^.^.^.^.^.^.^.^............................................
.............................................................................................................................................
...........................................^...^.^.^...^...^.^.^.^.^...^.....^.^.........^.^.^.^.^...........................................
.............................................................................................................................................
..........................................^...^.^.^.^.......^.^.^...^...^...^.^.^.^.....^.^.^...^.^..........................................
.............................................................................................................................................
.........................................^.^.^.^.^...^.^.^.^.^.^.^...^.^.^.....^.^.^...^.^.^.^.^...^.........................................
.............................................................................................................................................
........................................^.^.^.^.^...^...^...^...^.^.....^.......^.^...^...^.^.^.^.^.^........................................
.............................................................................................................................................
.......................................^...^...^...^.^...^.^...^.^.^...^.^.^.^.^.^...^.^.^.^.^.^.^...^.......................................
.............................................................................................................................................
......................................^.^.^.....^.^.^...^.^.^.^...^.^.^.^...^...^.^.^.^.........^.^.^.^......................................
.............................................................................................................................................
.....................................^.^...^...^.^.^...^.^.^.^.....^.^...^.^.^.^.^.......^...^.^...^.^.^.....................................
.............................................................................................................................................
....................................^.^.^.^.^.^.^.^.^.^...^.....^.^.^.^...^.^.^...^.^.^.^.^...^.^.^.^.^.^....................................
.............................................................................................................................................
...................................^.....^.^.......^...^.^.....^.^.^.^...^.....^.^.^.^.^...^...^...^...^.^...................................
.............................................................................................................................................
..................................^.^.^.^...^.^.....^.^...^.^.......^...^...^.....^.^.^.^.....^.^.^.^.^.^.^..................................
.............................................................................................................................................
.................................^...^.....^.^.^.^.^.^.....^...^...^.^...^.^.^...^.^.^.^.^.^.^.^.^.....^...^.................................
.............................................................................................................................................
................................^.^.......^.^.....^.^.^.....^.^...^...^.^.^.^...^.....^...^.^.^.^...^.^...^.^................................
.............................................................................................................................................
...............................^.^...^.^...^.......^...^.^.^.^.^.^.^.^.^...^.^.^.^.........^.^.^...^.^.^.^.^.^...............................
.............................................................................................................................................
..............................^.^.^.^...^.^...^.^.......^.....^.^.^.^.^.^...^.......^.^.^.^.^.^.^.^.^.......^.^..............................
.............................................................................................................................................
.............................^...^.....^.^.^.^.....^.^.^...^.^.^...^.......^.^.^.^.^.^.^.......^...^...^.^...^.^.............................
.............................................................................................................................................
............................^.^...^.^...^.^.^.^.^...^.^.......^.^.^.^.........^.^.^.........^.^.....^.^.^.^.^.^.^............................
.............................................................................................................................................
...........................^.^.^.^.^.^.^.^...^.^...^.^...^.^.^.....^.^.......^.....^.^.^.^...^.^.^.^.^.^.^...^.^.^...........................
.............................................................................................................................................
..........................^.^...^...^.^.^...^...^...^...^.....^.^...^.^.^.^.^...^.^...^.^.^.....^.^...^.^...^.^.^.^..........................
.............................................................................................................................................
.........................^.^.^.^.^.^.^.^.^.^.^.....^.^.......^...^.............^.^.^.^.^.......^.^.^.^.^.^.^.^...^.^.........................
.............................................................................................................................................
........................^.^.^.^...^...^.^.^.^.^.^.^.^.^.....^.^.........^.^.^.^.^.^.^.^.....^...^...^.^.^.^.^.^.^.^.^........................
.............................................................................................................................................
.......................^.^...^.^.....^.^.^...^...^...^.^...^.^.^.^.^.^.^.......^.^.^...^.^.^.....^.^...^...^.........^.......................
.............................................................................................................................................
......................^...^.^...^.....^...^.^.^.......^.^.^.^.^...^.^.^.^.^.^.^...^...^.........^.^.^...^.^...^.^.^...^......................
.............................................................................................................................................
.....................^.....^.^.^.^.^.^.^.^.^.^.^...^.^.^.^.^.^.^.^...^.^.^.^.^.....^...^.^.^.^.^...^.^.^.^.^.^.^.^.^.^.^.....................
.............................................................................................................................................
....................^.^.^.^...^.^.^.........^.^...^.^...^.^...^.^.^.....^.^.^.^.....^...^.^...^.^.^.....^...^.^.^.^.^.^.^....................
.............................................................................................................................................
...................^.^.^...^...^.^.^.^...^.^.^.^.^.^.^.^.^...^.^.^...^.^.^.^.^.^.^...^.^...^.^.^.^.^.^.^.^.^.^.^.........^...................
.............................................................................................................................................
..................^.^.^.^...^.....^...^...^.^.^.^.....^.^...^.^.^.^.^.^.^.^.^.......^.^.........^.....^.^.^.^.^.....^.^.^.^..................
.............................................................................................................................................
.................^.^.....^.....^.^.^.^...^...^.^.^.^...^.......^.^...^.^...^.^...^.........^...^.^.^.....^...^...^.^.....^.^.................
.............................................................................................................................................
................^.^...^.^.....^.^.^.^.^.^...^.^...^...^.......^.........^.^.^.^.^.^...........^...^.^.^.^.^.^...^...^.^.^...^................
.............................................................................................................................................
...............^.....^...^.^.^.........^.^.^.^.^.^.^.^...^.^.^...^...^.^...^.^.....^.^.....^...^.....^...^.^.....^.^.^.^...^.^...............
.............................................................................................................................................
..............^.^...^.^.^...^.......^.^.^.^...^...^.....^.^.^.^.^.^.^.^...^.^.^.^.^.^...^.^.^...^.^.^.^.^...^.^.^.^.^.....^...^..............
.............................................................................................................................................
.............^.^.^...^.^.^.^...^.^...^...^.^.^.^.....^...^.^.^.^.........^.^...^.^.^.........^...^...^...^.^.^.^.^.^.^.......^.^.............
.............................................................................................................................................
............^.^.^.^.^...^.^.^...^...^...^.^.^.^.^...^.^.^.^.^...^...^.....^.^.^.^.^...^...^...^.......^...^.^.^...^.^.^.^...^.^.^............
.............................................................................................................................................
...........^...^.....^...^.^.^.^.^.^.^.^.......^.......^...^.^.^.^.^...^.^...^.....^.^.......^.^...^.....^...^.^...^...^.....^.^.^...........
.............................................................................................................................................
..........^.^...^.^.^...^.............^.^.^.^.^.^.^...^.^.^.^.............^.^.^.^.^.^.^.^.......^.^.^.^...^.^.^.^.^...^.^.^.^.^...^..........
.............................................................................................................................................
.........^.....^...^.^.^.....^.^.^.^...^.^...^...^.^.^.^.^.^.^.....^.......^.^.^...^...^.^.^...^.^.^.....^.....^.^.^.^.^.....^.....^.........
.............................................................................................................................................
........^.^.^.^.^.^...^.....^.^...^.^.^.^.^.^.^.^.....^.^.^.^.^.......^...^...^.^...^...^.^.^.^.^.^.^.^.^.^.^...^.....^.^.^.....^...^........
.............................................................................................................................................
.......^.^.....^...^.....^.^.....^...^.^.....^...^.^...^.^.^.^.^.....^...^.^.^.^.....^.^...^.^...^.^.^.^...^.^.^.....^...^...^...^...^.......
.............................................................................................................................................
......^.^...^.^.^.....^.....^...^...^...^.^...^.^.^.^.............^...^.^...^.....^...^.^.^...^.^.^...^.^.^...^...^.^.^.^.......^.....^......
.............................................................................................................................................
.....^.^.^.^...^.^.^.^.^.^...^...^.^.^.^.....^.^.^.^.^.....^.^.^.^...^.^.^...^.^.^...^...^.....^.^.^.^.......^...^.^.^...^.^...^.^.^.^.^.....
.............................................................................................................................................
....^.^.^.^...^.^.^.^...^.^...^.^.^.^.......^.^.^.^.^.^.^...^.^...^.^.^.^.^...^.^.....^.^.^...^.^.^.^.^.^.^...^.....^.^.....^.^.^.^.^.^.^....
.............................................................................................................................................
...^.^.^.^.^.......^.^.^.^.^...^...^.^...^.^.......^.^...^.......^...........^.^.^.....^...^.^.^.^...^.........^.^...^...^.^.^.....^.^.^.^...
.............................................................................................................................................
..^.......^.^.^.^.^...^.^...^.^.^.^.^.^.....^.^.......^.^...^.^.^.^.^...^.^.^.^.....^.^.^.....^...^.^.....^...^.^.^.^.^.^.^...^.....^.^...^..
.............................................................................................................................................
.^.^.........^.^.^.^...^...^.^...^.^...^.^...^.^.^...^.^.......^...^.....^.^.^.^.^...^.^.^.^.^.^...^.^...^.^...^.^.^.^.^...^.^.^.^.^...^.^.^.
.............................................................................................................................................
"""

beam_splits = tachyon_manifold(manifold_input)
print(f"Total splits: {beam_splits}")
